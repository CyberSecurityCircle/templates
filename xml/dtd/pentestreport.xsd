<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" elementFormDefault="qualified"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xi="http://www.w3.org/2001/XInclude">
  <xs:import namespace="http://www.w3.org/XML/1998/namespace" schemaLocation="http://www.w3.org/2001/xml.xsd" />
  <xs:import namespace="http://www.w3.org/2001/XInclude" schemaLocation="http://www.w3.org/2001/XInclude/XInclude.xsd"/>
  <xs:element name="pentest_report">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="meta"/>
        <xs:element ref="generate_index"/>
        <xs:choice maxOccurs="unbounded">
          <xs:element ref="section"/>
        </xs:choice>
        <xs:element maxOccurs="unbounded" ref="appendix"/>
      </xs:sequence>
      <xs:attribute name="findingCode" use="required" type="xs:NCName"/>
      <xs:attribute name="findingNumberingBase" use="optional" default="Report"> 
        <xs:simpleType> 
          <xs:restriction base="xs:string"> 
            <xs:enumeration value="Report"/>
            <xs:enumeration value="Section"/>
          </xs:restriction> 
        </xs:simpleType> 
      </xs:attribute>
    </xs:complexType>
  </xs:element>
  <xs:element name="meta">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="title"/>
        <xs:element ref="client"/>
        <xs:element ref="targets"/>
        <xs:element ref="collaborators"/>
        <xs:element ref="classification"/>
        <xs:element ref="version_history"/>
        <xs:element ref="contact"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="client">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="full_name"/>
        <xs:element ref="short_name"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="full_name" type="xs:string"/>
  <xs:element name="short_name" type="xs:string"/>
  <xs:element name="targets">
    <xs:complexType>
      <xs:sequence>
        <xs:element maxOccurs="unbounded" ref="target"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="target" type="xs:string"/>
  <xs:element name="collaborators">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="reviewers"/>
        <xs:element ref="approver"/>
        <xs:element ref="pentesters"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="reviewers">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="reviewer"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="reviewer" type="xs:string"/>
  <xs:element name="approver" type="xs:string"/>
  <xs:element name="pentesters">
    <xs:complexType>
      <xs:sequence>
        <xs:element maxOccurs="unbounded" ref="pentester"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="pentester">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="name"/>
        <xs:element ref="bio"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="bio" type="xs:string"/>
  <xs:element name="classification" type="xs:NCName"/>
  <xs:element name="version_history">
    <xs:complexType>
      <xs:sequence>
        <xs:element maxOccurs="unbounded" ref="version"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="version">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="v_author" maxOccurs="unbounded"/>
        <xs:element ref="v_description"/>
      </xs:sequence>
      <xs:attribute name="date" use="required" type="xs:date"/>
      <xs:attribute name="number" use="required" type="xs:NMTOKEN"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="contact">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="name"/>
        <xs:element ref="address"/>
        <xs:element ref="phone"/>
        <xs:element ref="email"/>
      </xs:sequence>
      <xs:attribute ref="xml:base"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="address">
    <xs:complexType mixed="true">
      <xs:sequence>
        <xs:element minOccurs="0" maxOccurs="unbounded" ref="br"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="phone" type="xs:string"/>
  <xs:element name="email" type="xs:string"/>
  <xs:element name="generate_index">
    <xs:complexType/>
  </xs:element>
  <xs:element name="generate_targets">
    <xs:complexType/>
  </xs:element>
  <xs:element name="appendix">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="title"/>
        <xs:choice maxOccurs="unbounded">
          <xs:element ref="generate_testteam"/>
          <xs:element name="p" type="block"/>
          <xs:element ref="pre"/>
          <xs:element ref="table"/>
          <xs:element ref="ol"/>
          <xs:element ref="ul"/>
          <xs:element ref="img"/>
          <xs:element ref="section"/>
        </xs:choice>
      </xs:sequence>
      <xs:attribute name="id" use="required" type="xs:NCName"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="generate_testteam">
    <xs:complexType/>
  </xs:element>
  <xs:element name="title" type="xs:string"/>
  <xs:element name="v_author" type="xs:string"/>
  <xs:element name="v_description" type="xs:string"/>
  <xs:element name="name" type="xs:string"/>
  <xs:element name="br">
    <xs:complexType/>
  </xs:element>
  <xs:element name="section">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="title"/>
        <xs:choice minOccurs="0" maxOccurs="unbounded">
          <xs:element ref="pre"/>
          <xs:element name="p" type="block"/>
          <xs:element ref="section"/>
          <xs:element ref="table"/>
          <xs:element ref="ul"/>
          <xs:element ref="ol"/>
          <xs:element ref="img"/>
          <xs:element ref="generate_targets"/>
        </xs:choice>
        <xs:choice>
          <xs:element ref="generate_recommendations"/>
          <xs:element minOccurs="0" maxOccurs="unbounded" ref="generate_findings"/>
          <xs:element minOccurs="0" maxOccurs="unbounded" ref="finding"/>
          <xs:element minOccurs="0" maxOccurs="unbounded" ref="non-finding"/>
        </xs:choice>
      </xs:sequence>
      <xs:attribute name="id" use="required" type="xs:ID"/>
      <xs:attribute name="break" use="optional">
        <xs:simpleType> 
          <xs:restriction base="xs:string"> 
            <xs:enumeration value="before"/>
            <xs:enumeration value="after"/>
          </xs:restriction> 
        </xs:simpleType>
      </xs:attribute>
      <xs:attribute ref="xml:base"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="non-finding">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="title"/>
        <xs:choice minOccurs="0" maxOccurs="unbounded">
          <xs:element ref="pre"/>
          <xs:element name="p" type="block"/>
          <xs:element ref="table"/>
          <xs:element ref="ul"/>
          <xs:element ref="ol"/>
          <xs:element ref="img"/>
        </xs:choice>
        <xs:choice>
          <xs:element ref="generate_recommendations"/>
          <xs:element minOccurs="0" maxOccurs="unbounded" ref="generate_findings"/>
          <xs:element minOccurs="0" maxOccurs="unbounded" ref="finding"/>
        </xs:choice>
      </xs:sequence>
      <xs:attribute name="id" use="required" type="xs:ID"/>
      <xs:attribute ref="xml:base"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="table">
    <xs:complexType>
      <xs:sequence>
        <xs:element maxOccurs="unbounded" ref="tr"/>
      </xs:sequence>
      <xs:attribute name="border" use="optional" type="xs:integer"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="tr">
    <xs:complexType>
      <xs:choice maxOccurs="unbounded" minOccurs="1">
        <xs:element ref="td"/>
        <xs:element ref="th"/>
      </xs:choice>
    </xs:complexType>
  </xs:element>
  <xs:element name="td">
    <xs:complexType mixed="true">
      <xs:choice maxOccurs="unbounded">
        <xs:element minOccurs="0" maxOccurs="unbounded" ref="a"/>
        <xs:element minOccurs="0" maxOccurs="unbounded" ref="b"/>
        <xs:element minOccurs="0" maxOccurs="unbounded" ref="br"/>
        <xs:element minOccurs="0" maxOccurs="unbounded" ref="i"/>
        <xs:element minOccurs="0" maxOccurs="unbounded" ref="u"/>
      </xs:choice>
    </xs:complexType>
  </xs:element>
  <xs:element name="th" type="xs:string"/>
  <xs:element name="ul">
    <xs:complexType>
      <xs:sequence>
        <xs:element maxOccurs="unbounded" name="li" type="li"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="ol">
    <xs:complexType>
      <xs:sequence>
        <xs:element maxOccurs="unbounded" name="li" type="li"/>
      </xs:sequence>
      <xs:attribute name="type" use="optional">
        <xs:simpleType>
          <xs:restriction base="xs:string">
            <xs:enumeration value="a"/>
            <xs:enumeration value="A"/>
            <xs:enumeration value="i"/>
            <xs:enumeration value="I"/>
          </xs:restriction>
        </xs:simpleType>
      </xs:attribute>
    </xs:complexType>
  </xs:element>
  <xs:complexType name="block" mixed="true">
    <xs:choice maxOccurs="unbounded">
      <xs:element minOccurs="0" maxOccurs="unbounded" ref="a"/>
      <xs:element minOccurs="0" maxOccurs="unbounded" ref="b"/>
      <xs:element minOccurs="0" maxOccurs="unbounded" ref="br"/>
      <xs:element minOccurs="0" maxOccurs="unbounded" ref="i"/>
      <xs:element minOccurs="0" maxOccurs="unbounded" ref="u"/>
    </xs:choice>
  </xs:complexType>
  <xs:complexType name="li" mixed="true">
    <xs:choice maxOccurs="unbounded">
      <xs:element minOccurs="0" maxOccurs="unbounded" ref="a"/>
      <xs:element minOccurs="0" maxOccurs="unbounded" ref="b"/>
      <xs:element minOccurs="0" maxOccurs="unbounded" ref="br"/>
      <xs:element minOccurs="0" maxOccurs="unbounded" ref="i"/>
      <xs:element minOccurs="0" maxOccurs="unbounded" ref="u"/>
      <xs:element minOccurs="0" maxOccurs="unbounded" ref="ul"/>
      <xs:element minOccurs="0" maxOccurs="unbounded" ref="ol"/>
    </xs:choice>
  </xs:complexType>
  <xs:element name="generate_recommendations">
    <xs:complexType/>
  </xs:element>
  <xs:element name="generate_findings">
    <xs:complexType>
      <xs:attribute name="Ref" use="optional" type="xs:IDREF"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="finding">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="title"/>
        <xs:element ref="description"/>
        <xs:choice minOccurs="0" maxOccurs="1">
          <xs:element ref="description_summary"/>
        </xs:choice>
        <xs:element ref="technicaldescription"/>
        <xs:element ref="impact"/>
        <xs:element ref="recommendation"/>
      </xs:sequence>
      <xs:attribute name="id" use="required" type="xs:ID"/>
      <xs:attribute name="threatLevel" use="optional" default="N/A">
        <xs:simpleType> 
          <xs:restriction base="xs:string"> 
            <xs:enumeration value="N/A"/>
            <xs:enumeration value="Low"/>
            <xs:enumeration value="Moderate"/>
            <xs:enumeration value="Elevated"/>
            <xs:enumeration value="High"/>
            <xs:enumeration value="Extreme"/>
          </xs:restriction> 
        </xs:simpleType>
      </xs:attribute>
      <xs:attribute name="type" use="required"/>
      <xs:attribute ref="xml:base"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="description">
    <xs:complexType mixed="true">
      <xs:choice maxOccurs="unbounded" minOccurs="0">
        <xs:element name="p" type="block"/>
        <xs:element name="ol"/>
        <xs:element name="ul"/>
        <xs:element name="img"/>
        <xs:element name="table"/>
        <xs:element ref="pre"/>
      </xs:choice>
    </xs:complexType>
  </xs:element>
  <xs:element name="description_summary">
    <xs:complexType mixed="true">
      <xs:sequence maxOccurs="unbounded" minOccurs="0">
        <xs:element name="p" type="block"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="technicaldescription">
    <xs:complexType mixed="true">
      <xs:choice maxOccurs="unbounded" minOccurs="0">
        <xs:element name="p" type="block"/>
        <xs:element name="ol"/>
        <xs:element name="ul"/>
        <xs:element name="img"/>
        <xs:element name="table"/>
        <xs:element ref="pre"/>
      </xs:choice>
    </xs:complexType>
  </xs:element>
  <xs:element name="img">
    <xs:complexType>
      <xs:attribute name="height" use="optional" type="xs:integer"/>
      <xs:attribute name="width" use="optional" type="xs:integer"/>
      <xs:attribute name="src" use="required"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="impact">
    <xs:complexType mixed="true">
      <xs:choice maxOccurs="unbounded" minOccurs="0">
        <xs:element name="p" type="block"/>
        <xs:element name="ol"/>
        <xs:element name="ul"/>
        <xs:element name="img"/>
        <xs:element name="table"/>
        <xs:element ref="pre"/>
      </xs:choice>
    </xs:complexType>
  </xs:element>
  <xs:element name="recommendation">
    <xs:complexType mixed="true">
      <xs:choice maxOccurs="unbounded" minOccurs="0">
        <xs:element name="p" type="block"/>
        <xs:element name="ol"/>
        <xs:element name="ul"/>
        <xs:element name="img"/>
        <xs:element name="table"/>
        <xs:element ref="pre"/>
      </xs:choice>
    </xs:complexType>
  </xs:element>
  <xs:element name="pre">
    <xs:complexType mixed="true">
      <xs:choice>
        <xs:element minOccurs="0" maxOccurs="unbounded" ref="a"/>
        <xs:element minOccurs="0" maxOccurs="unbounded" ref="b"/>
        <xs:element minOccurs="0" maxOccurs="unbounded" ref="br"/>
        <xs:element minOccurs="0" maxOccurs="unbounded" ref="i"/>
        <xs:element minOccurs="0" maxOccurs="unbounded" ref="u"/>
      </xs:choice>
    </xs:complexType>
  </xs:element>
  <xs:element name="a">
    <xs:complexType>
      <xs:simpleContent>
        <xs:extension base="xs:string">
          <xs:attribute name="href" use="required" type="xs:anyURI"/>
        </xs:extension>
      </xs:simpleContent>
    </xs:complexType>
  </xs:element>
  <xs:element name="b">
    <xs:complexType mixed="true">
      <xs:choice maxOccurs="unbounded">
        <xs:element minOccurs="0" maxOccurs="unbounded" ref="a"/>
        <xs:element minOccurs="0" maxOccurs="unbounded" ref="br"/>
        <xs:element minOccurs="0" maxOccurs="unbounded" ref="i"/>
        <xs:element minOccurs="0" maxOccurs="unbounded" ref="u"/>
      </xs:choice>
    </xs:complexType>
  </xs:element>
  <xs:element name="i">
    <xs:complexType mixed="true">
      <xs:choice maxOccurs="unbounded">
        <xs:element minOccurs="0" maxOccurs="unbounded" ref="a"/>
        <xs:element minOccurs="0" maxOccurs="unbounded" ref="b"/>
        <xs:element minOccurs="0" maxOccurs="unbounded" ref="br"/>
        <xs:element minOccurs="0" maxOccurs="unbounded" ref="u"/>
      </xs:choice>
    </xs:complexType>
  </xs:element>
  <xs:element name="u">
    <xs:complexType mixed="true">
      <xs:choice maxOccurs="unbounded">
        <xs:element minOccurs="0" maxOccurs="unbounded" ref="a"/>
        <xs:element minOccurs="0" maxOccurs="unbounded" ref="b"/>
        <xs:element minOccurs="0" maxOccurs="unbounded" ref="br"/>
        <xs:element minOccurs="0" maxOccurs="unbounded" ref="i"/>
      </xs:choice>
    </xs:complexType>
  </xs:element>
</xs:schema>
